---
title: "T028 otolith/GT-seq match: First live test of 12 96-well transfer plates"
output:
  html_notebook:
    theme: united
    toc: yes
editor_options: 
  chunk_output_type: inline
---

```{r setup, message=FALSE, results='hide'}
rm(list=ls())

knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(lubridate)
library(DT)
library(abind)
bbind <- function(...) { abind(..., along = 3) }

.username <- "kmgruenthal"
.password <- ""

source("~/R/Functions.GCL.R")
source("../../GOD/LOKI2R_ind.GCL.R")
source("../../GOD/DupCheckBetweenSillys_all.GCL.r")
```

# Objective

The purpose of this notebook is to determine whether we can successfully re-pair GTseq genotypes from otolith-derived DNA with GT-seq genotypes from heart-derived DNA for individuals of unknown origin.

# Background

During shipment of otolith samples to the MTA in Juneau for reading, a significant proportion of otoliths migrated between cells within DWPs due to poor containment of the acetate lids that were attached with rubber bands to the DWPs. This incident is known as "the great otolith debacle", aka the "GOD" incident. Since some otoliths moved from their original cells in the DWP, the paired integrity of the otolith-origin information and the rest of the paired data (genotype + field data) was lost for many individuals. In an attempt to rectify the "GOD" incident, we are extracting DNA from the otolith tissues, genotyping the otolith-derived DNA at 298 GT-seq loci, and attempting to re-pair the otolith-heart samples from their genotypes.  

# Methods

DNA was extracted from left-side or unknown otolith tissues of unknown origin using conventional Machery-Nagel DNA extraction kits. Otoliths were placed in T1 buffer for an overnight soak in clear 96 shallow-well plates (SWP). Preamp at 14 cycles. Final elution volume was 75uL. All otoliths were transferred among plates with a jig. All liquid handling was done by robot. 

## LocusControl

```{r}
TestSillys <- "PGOD21"

loci <- dget("../../Objects/loci298.txt") # saved list of loci

CreateLocusControl.GCL(locusnames = loci, username = .username, password = .password)
loci <- LocusControl$locusnames
nalleles <- LocusControl$nalleles
ploidy <- LocusControl$ploidy
alleles <- LocusControl$alleles

# change sillyvec as needed
LOKI2R.GCL(sillyvec = TestSillys, username = .username, password = .password)
```

```{r}
# create a csv from the otolith transfer spreadsheet from MTAL, read in the data, and create a concatenated tray and well column
oto_xfer_data_042721 <- read_csv("otolith_transfer_042721.csv")
oto_xfer_data_042721$DNA_TRAY_AND_WELL <- paste0(oto_xfer_data_042721$`96_oto_tray_barcode`, "_", oto_xfer_data_042721$`96_oto_tray_position`)
  
# download csv of PGOD21 sample data from OceanAK and append with _PGOD21
oceanak_PGOD21 <- read_csv("GEN_SAMPLED_FISH_TISSUE_PGOD21.csv")

# pull the attributes table from PGOD21.gcl, create a new tray a well column, and join with the otolith transfer data
attributes_PGOD21 <- PGOD21.gcl$attributes %>%
  transform(DNA_TRAY_CODE = as.numeric(DNA_TRAY_CODE))
attributes_PGOD21$DNA_TRAY_AND_WELL <- paste0(attributes_PGOD21$DNA_TRAY_CODE, "_", attributes_PGOD21$DNA_TRAY_WELL_CODE)
attributes_and_xfer_PGOD21 <- left_join(attributes_PGOD21, oto_xfer_data_042721, by = "DNA_TRAY_AND_WELL")

# get a list of the affected DWPs
affected_DWPs <- unique(attributes_and_xfer_PGOD21$`48_DWP_tray_barcode`)

# filter OceanAK data pull for the list of affected DWPs
AHRP_oceanak_pull_092021 <- read_csv(file = "../../OceanAK/AHRP Salmon Biological Data 20210920_135754.csv") # do a new pull if latest date stamp is old
oceanak_affected_DWPs <- AHRP_oceanak_pull_092021[AHRP_oceanak_pull_092021$DNA_TRAY_CODE %in% affected_DWPs, ]
write_csv(oceanak_affected_DWPs, "oceanak_affected_DWPs.csv")

# get SILLYs and fish IDs for affected DWPs
DWP_sillys <- unique(oceanak_affected_DWPs$SILLY_CODE)

DWP_fish_ids <- oceanak_affected_DWPs %>% 
  dplyr::select(SILLY_CODE, FISH_ID) 

PERB15_fish_ids <- DWP_fish_ids %>% 
  dplyr::filter(SILLY_CODE == "PERB15") %>% 
  pull(FISH_ID)
PERB16_fish_ids <- DWP_fish_ids %>% 
  dplyr::filter(SILLY_CODE == "PERB16") %>% 
  pull(FISH_ID)
PERB17_fish_ids <- DWP_fish_ids %>% 
  dplyr::filter(SILLY_CODE == "PERB17") %>% 
  pull(FISH_ID)
PGILMOUR15_fish_ids <- DWP_fish_ids %>% 
  dplyr::filter(SILLY_CODE == "PGILMOUR15") %>% 
  pull(FISH_ID)
PGILMOUR16_fish_ids <- DWP_fish_ids %>% 
  dplyr::filter(SILLY_CODE == "PGILMOUR16") %>% 
 pull(FISH_ID)
PGILMOUR17_fish_ids <- DWP_fish_ids %>% 
  dplyr::filter(SILLY_CODE == "PGILMOUR17") %>% 
  pull(FISH_ID)
PGILMOUR18_fish_ids <- DWP_fish_ids %>% 
  dplyr::filter(SILLY_CODE == "PGILMOUR18") %>% 
  pull(FISH_ID)
PPADDY16_fish_ids <- DWP_fish_ids %>% 
  dplyr::filter(SILLY_CODE == "PPADDY16") %>% 
  pull(FISH_ID)

# Project SILLYs
# Note that some SILLYs are included in the affected DWPs whose hearts haven't been genotyped yet (e.g., PERB15 and PERB17)

# By otolith transfer plate ID
# Plate50917 <- c("PGILMOUR15", "PPADDY16")
# Plate50927 <- c("PGILMOUR15", "PGILMOUR16")
# Plate50936 <- c("PERB16")
# Plate50947 <- c("PGILMOUR17", "PGILMOUR18")
# Plate50956 <- c("PERB16")
# Plate50964 <- c("PGILMOUR17", "PGILMOUR18")
# Plate50974 <- c("PERB16", "PGILMOUR17", "PGILMOUR18")
# Plate50994 <- c("PERB16")
# Plate50995 <- c("PGILMOUR18", "PPADDY16")
# Plate50997 <- c("PGILMOUR16")
# Plate50999 <- c("PPADDY16", "PGILMOUR17", "PGILMOUR18")
# Plate51000 <- c("PGILMOUR15", "PGILMOUR17", "PGILMOUR18")

# By individuals in a SILLY per affected DWP
# PERB15 <- "PERB15"
# LOKI2R_ind.GCL(sillyvec = PERB15, fish_ids = PERB15_fish_ids, username = .username, password = .password)

PERB16 <- "PERB16"
LOKI2R_ind.GCL(sillyvec = PERB16, fish_ids = PERB16_fish_ids, username = .username, password = .password)

# PERB17 <- "PERB17"
# LOKI2R_ind.GCL(sillyvec = PERB17, fish_ids = PERB17_fish_ids, username = .username, password = .password)

PGILMOUR15 <- "PGILMOUR15"
LOKI2R_ind.GCL(sillyvec = PGILMOUR15, fish_ids = PGILMOUR15_fish_ids, username = .username, password = .password)

PGILMOUR16 <- "PGILMOUR16"
LOKI2R_ind.GCL(sillyvec = PGILMOUR16, fish_ids = PGILMOUR16_fish_ids, username = .username, password = .password)

PGILMOUR17 <- "PGILMOUR17"
LOKI2R_ind.GCL(sillyvec = PGILMOUR17, fish_ids = PGILMOUR17_fish_ids, username = .username, password = .password)

PGILMOUR18 <- "PGILMOUR18"
LOKI2R_ind.GCL(sillyvec = PGILMOUR18, fish_ids = PGILMOUR18_fish_ids, username = .username, password = .password)

PPADDY16 <- "PPADDY16"
LOKI2R_ind.GCL(sillyvec = PPADDY16, fish_ids = PPADDY16_fish_ids, username = .username, password = .password)
```

Create new directories and save objects

```{r save_locus_control_sillys}
if(!dir.exists("../../Objects/GOD_21_Round1/")) {dir.create("../../Objects/GOD_21_Round1/")}
save_objects(objects = c("LocusControl", "loci", "TestSillys", "PERB16", "PGILMOUR15", "PGILMOUR16", "PGILMOUR17", "PGILMOUR18", "PPADDY16"), path = "../../Objects/GOD_21_Round1/")

if(!dir.exists("../../Genotypes/GOD_21_Round1/")) {dir.create("../../Genotypes/GOD_21_Round1/")}
save_sillys(sillyvec = c("PGOD21", "PERB16", "PGILMOUR15", "PGILMOUR16", "PGILMOUR17", "PGILMOUR18", "PPADDY16"), path = "../../Genotypes/GOD_21_Round1/")
```

### Otolith genotyping success

```{r fig.height=12}
TestQCSampleSizebyLocus <-
  SampSizeByLocus.GCL(sillyvec = TestSillys, loci = loci)

TestQCPercentbyLocus <-
  apply(TestQCSampleSizebyLocus, 1, function(row) {
    row / max(row)
  })

(locus_success_rate_qc <- TestQCPercentbyLocus %>% 
  as_tibble(rownames = "locus") %>%
  dplyr::rename(success_rate = PGOD21) %>%
  arrange(success_rate))

locus_success_rate_qc %>%
  filter(success_rate == 0)

(failed_loci_otoliths <- locus_success_rate_qc %>%
  filter(success_rate == 0) %>%
  pull(locus))

# Added by Chase Jalbert on 4/2020. This version of a levelplot has WAY more features and actually works with large datasets.
# plotly::ggplotly(
#   ggplot(
#     TestQCPercentbyLocus %>%
#       as_tibble(rownames = "locus") %>%
#       gather(silly, percent,-locus),
#     aes(x = silly, y = locus)
#   ) +
#     geom_tile(aes(fill = percent), color = "white") +
#     scale_fill_gradient(
#       low = "black",
#       high = "white",
#       limits = c(0, 1)
#     ) +
#     ylab("Locus") +
#     xlab("SILLY") +
#     ggtitle("Percent PGOD21 genotyped by Locus") +
#     labs(fill = "Percent\ngenotyped")
# )

# You can zoom, click things, scroll, save image, etc. so you can actually see whats going on...but it keeps failing ("Error in dirname(to) : path too long") and I'm not in the mood to move things around, so back to normal ggplot...
TestQCPercentbyLocus %>%
  as_tibble(rownames = "locus") %>%
  gather(silly, percent,-locus) %>%
  ggplot(aes(x = silly, y = locus)) +
    geom_tile(aes(fill = percent), color = "white") +
    scale_fill_gradient(
      low = "black",
      high = "white",
      limits = c(0, 1)
    ) +
    ylab("Locus") +
    xlab("SILLY") +
    ggtitle("Percent genotyped by silly/locus") +
    labs(fill = "Percent\ngenotyped")
```

**0 / 298** loci failed; all rates >10% (see table).  Some loci aren't too pretty, though.

## QA project genotypes

### Otoliths

#### Remove fails and dupes

Need to remove any particularly egregious project fish. *Here's where we can decide our cutoff, if any, for minimum number of loci.*

```{r}
PGOD21.gcl$counts[, , 1] %>% 
  as_tibble(rownames = "fish_id") %>% 
  gather(locus, genotype, -fish_id) %>% 
  group_by(fish_id) %>% 
  summarise(proportion_missing = sum(is.na(genotype)) / length(loci)) %>% 
  arrange(desc(proportion_missing))
```

There are 1,120 total otos in PGOD21 this first test round. If we went by the usual 80% rule on all 298 loci, we'd lose 692 otos, which is honestly not as bad as I thought considering what we're dealing with. HOWEVER, we need to keep as many critters as possible. Plus, we're dealing with 298 loci, so we should have wiggle room. Consider that the original panel was 96 (32% of loci) and we though of paring that down to 24 (8% of loci). Here, though, we have to remember that the info content of each locus is not the same. 

So, for a first pass, let's try a 1% cutoff giving us a minimum of 3 loci that must be genotyped, losing 19 otos and leaving us with 1,101. We'll also largely skip the duplicate check (set at 99% matching), since it probably won't do us much good; we have (1) a low potential to identify true dupes, if only a few loci are genotyped, and (2) both lefts and unknowns are in PGOD21, which could come from the same fish. *NOTE: if this doesn't work well, as an alternate, we'll try a 10% cutoff giving us a minimum of 30 loci that must be genotyped and losing 85 fish, leaving us with 1,035 fishies. We'll keep the internal duplicate rate check at 99%.* 

```{r}
TestSillys_SampleSizes <-
  matrix(
    data = NA,
    nrow = length(TestSillys),
    ncol = 4,
    dimnames = list(TestSillys, c(
      "Genotyped", "Missing", "Duplicate", "Final"
    ))
  )

TestSillys_SampleSizes[, "Genotyped"] <-
  sapply(paste(TestSillys, ".gcl", sep = ''), function(x)
    get(x)$n)


(MissLoci <-
    RemoveIndMissLoci.GCL(sillyvec = TestSillys, proportion = 0.01))

ColSizePostMissLoci <-
  sapply(paste(TestSillys, ".gcl", sep = ''), function(x)
    get(x)$n)

TestSillys_SampleSizes[, "Missing"] <- TestSillys_SampleSizes[, "Genotyped"] - ColSizePostMissLoci

DuplicateCheck99MinProportion <-
  CheckDupWithinSilly.GCL(
    sillyvec = TestSillys,
    loci = loci,
    quantile = NULL,
    minproportion = 0.99
  )

DuplicateCheckReportSummary <-
  sapply(TestSillys, function(x)
    DuplicateCheck99MinProportion[[x]]$report, simplify = FALSE)

DuplicateCheckReportSummary

nDupsBySilly <-
  sapply(DuplicateCheckReportSummary, function(silly) {
    ifelse(is.character(silly), 0, nrow(as.matrix(silly)))
  })
RemovedDups <- RemoveDups.GCL(DuplicateCheck99MinProportion)

sapply(DuplicateCheckReportSummary[nDupsBySilly >= 1], function(silly) {
  if (1 %in% abs(as.numeric(levels(silly$ID1)) - as.numeric(levels(silly$ID2)))) {
    "Sequential IDs found as duplicates, check 'DuplicateCheckReportSummary' for duplicated rows"
  } else {
    "Duplicates exist, but IDs do not appear sequential"
  }
})

DuplicateCheckReportSummary[nDupsBySilly >= 1]  # Show within silly duplicates

ColSizePostDuplicate <- ColSizePostMissLoci - nDupsBySilly
ColSizePostDuplicate <- sapply(paste(TestSillys, ".gcl", sep = ''), function(x) get(x)$n)

TestSillys_SampleSizes[, "Duplicate"] <-
  ColSizePostMissLoci - ColSizePostDuplicate

TestSillys_SampleSizes[, "Final"] <- ColSizePostDuplicate

TestSillys_SampleSizes
```

**1 / 1101**  otos may be a duplicate. IDs aren't sequential (623 and 635), but they may have been in the same well jumbledtogether. We can look a bit more closely at the specifics of these two, if we really want.

#### Heterozygosity

Excess heterozygosity can be an indication of contamination. We already know there is some contamination among the heart-derived GT-seq genotypes, but it is a good baseline.

```{r}
Ho_qc <- function(indata1 = PGOD21.gcl$counts[ , , 1]) {
  indata1 %>% 
  as_tibble(rownames = "qc_fish_id") %>% 
  gather(locus, genotype, -qc_fish_id) %>% 
  group_by(qc_fish_id) %>% 
  summarise(Ho_qc = sum(genotype == 1, na.rm = TRUE) / length(!is.na(genotype)), .groups = "drop") %>% 
  arrange(desc(Ho_qc))
}

Ho_qc_plot <- function(indata2 = Ho_qc_PGOD21) {
  indata2 %>% 
  ggplot(aes(x = Ho_qc)) +
  geom_histogram(binwidth = 1/298) +
  theme_bw()
}

Ho_qc_PGOD21 <- Ho_qc()
Ho_qc_plot()
```

Ho is high for some otoliths, definitely due to contamination.

#### Genotyping success

Let's look at it again visually.

```{r}
# loci_intersect <- setdiff(loci, failed_loci_otoliths) # all 298 are there

qc_proportion_missing <- function(indata3 = PGOD21.gcl$counts[, , 1]) {
    indata3 %>%
    as_tibble(rownames = "fish_id") %>%
    gather(locus, genotype,-fish_id) %>%
    group_by(fish_id) %>%
    summarise(proportion_missing = sum(is.na(genotype)) / 298) %>%
    arrange(desc(proportion_missing))
}

qc_proportion_missing_plot <- function(indata4 = qc_proportion_missing_PGOD21) {
  indata4 %>% 
  ggplot(aes(x = proportion_missing)) +
  geom_histogram() +
  xlim(0, 1.1) +
  theme_bw()
}

qc_proportion_missing_PGOD21 <- qc_proportion_missing()
qc_proportion_missing_plot()
```

Yeah, it's not pretty, but we knew that.

### Hearts

#### Remove fails and dupes

For the other SILLYS we'll compare to, we'll leave the cutoff at 80% and perform the regular 95% duplicate rate check.

```{r}
OGSillys <- c("PERB16", "PGILMOUR15", "PGILMOUR16", "PGILMOUR17", "PGILMOUR18", "PPADDY16")

OGSillys_SampleSizes <-
  matrix(
    data = NA,
    nrow = length(OGSillys),
    ncol = 4,
    dimnames = list(OGSillys, c(
      "Genotyped", "Missing", "Duplicate", "Final"
    ))
  )

OGSillys_SampleSizes[, "Genotyped"] <-
  sapply(paste(OGSillys, ".gcl", sep = ''), function(x)
    get(x)$n)


(MissLoci <-
    RemoveIndMissLoci.GCL(sillyvec = OGSillys, proportion = 0.8))

ColSizePostMissLoci <-
  sapply(paste(OGSillys, ".gcl", sep = ''), function(x)
    get(x)$n)

OGSillys_SampleSizes[, "Missing"] <- OGSillys_SampleSizes[, "Genotyped"] - ColSizePostMissLoci

DuplicateCheck95MinProportion <-
  CheckDupWithinSilly.GCL(
    sillyvec = OGSillys,
    loci = loci,
    quantile = NULL,
    minproportion = 0.95
  )

DuplicateCheckReportSummary <-
  sapply(OGSillys, function(x)
    DuplicateCheck95MinProportion[[x]]$report, simplify = FALSE)

DuplicateCheckReportSummary

nDupsBySilly <-
  sapply(DuplicateCheckReportSummary, function(silly) {
    ifelse(is.character(silly), 0, nrow(as.matrix(silly)))
  })
RemovedDups <- RemoveDups.GCL(DuplicateCheck95MinProportion)

sapply(DuplicateCheckReportSummary[nDupsBySilly >= 1], function(silly) {
  if (1 %in% abs(as.numeric(levels(silly$ID1)) - as.numeric(levels(silly$ID2)))) {
    "Sequential IDs found as duplicates, check 'DuplicateCheckReportSummary' for duplicated rows"
  } else {
    "Duplicates exist, but IDs do not appear sequential"
  }
})

DuplicateCheckReportSummary[nDupsBySilly >= 1]  # Show within silly duplicates

ColSizePostDuplicate <- ColSizePostMissLoci - nDupsBySilly
ColSizePostDuplicate <- sapply(paste(OGSillys, ".gcl", sep = ''), function(x) get(x)$n)

OGSillys_SampleSizes[, "Duplicate"] <-
  ColSizePostMissLoci - ColSizePostDuplicate

OGSillys_SampleSizes[, "Final"] <- ColSizePostDuplicate

OGSillys_SampleSizes
```

Losing a few more here as expected in terms of missingness. Only one dupe in PGILMOUR16. This is what we'd filter in a normal project anyway, although we lost more than a third of PERB16.

#### Heterozygosity

```{r}
# Ho_qc_PERB16 <- Ho_qc(PERB16.gcl$counts[, , 1])
# Ho_qc_PGILMOUR15 <- Ho_qc(PGILMOUR15.gcl$counts[, , 1])
# Ho_qc_PGILMOUR16 <- Ho_qc(PGILMOUR16.gcl$counts[, , 1])
# Ho_qc_PGILMOUR17 <- Ho_qc(PGILMOUR17.gcl$counts[, , 1])
# Ho_qc_PGILMOUR18 <- Ho_qc(PGILMOUR18.gcl$counts[, , 1])
# Ho_qc_PPADDY16 <- Ho_qc(PPADDY16.gcl$counts[, , 1])
# 
# 
# Ho_qc_plot(Ho_qc_PERB16)
# Ho_qc_plot(Ho_qc_PGILMOUR15)
# Ho_qc_plot(Ho_qc_PGILMOUR16)
# Ho_qc_plot(Ho_qc_PGILMOUR17)
# Ho_qc_plot(Ho_qc_PGILMOUR18)
# Ho_qc_plot(Ho_qc_PPADDY16)
```

Ho is higher for some hearts, likely due to contamination, but we already knew this, and compared to the PGOD21 otos, it's pretty low.

#### Genotyping success

```{r}
# qc_proportion_missing_PERB16 <- qc_proportion_missing(PERB16.gcl$counts[, , 1])
# qc_proportion_missing_PGILMOUR15 <- qc_proportion_missing(PGILMOUR15.gcl$counts[, , 1])
# qc_proportion_missing_PGILMOUR16 <- qc_proportion_missing(PGILMOUR16.gcl$counts[, , 1])
# qc_proportion_missing_PGILMOUR17 <- qc_proportion_missing(PGILMOUR17.gcl$counts[, , 1])
# qc_proportion_missing_PGILMOUR18 <- qc_proportion_missing(PGILMOUR18.gcl$counts[, , 1])
# qc_proportion_missing_PPADDY16 <- qc_proportion_missing(PPADDY16.gcl$counts[, , 1])
# 
# qc_proportion_missing_plot(qc_proportion_missing_PERB16)
# qc_proportion_missing_plot(qc_proportion_missing_PGILMOUR15)
# qc_proportion_missing_plot(qc_proportion_missing_PGILMOUR16)
# qc_proportion_missing_plot(qc_proportion_missing_PGILMOUR17)
# qc_proportion_missing_plot(qc_proportion_missing_PGILMOUR18)
# qc_proportion_missing_plot(qc_proportion_missing_PPADDY16)
```

Lots less missing in the hearts, except again maybe PERB16.

### Final dataset sample sizes

```{r}
PGOD21.gcl$n
PERB16.gcl$n
PGILMOUR15.gcl$n
PGILMOUR16.gcl$n
PGILMOUR17.gcl$n
PGILMOUR18.gcl$n
PPADDY16.gcl$n
```

We have a handful o' possible fishies to match back to. As a reminder, PGOD21 genotyped more SILLYs and DWPs than we have heart genotypes for, which comes into play when we do the DWP-by-DWP matching.

## Duplicate rate check

### Arrange attributes by DWPs
```{r}
# figure out the SILLYs associated with the DWPs and join
PGOD21_DWPs <- attributes_and_xfer_PGOD21 %>% 
  dplyr::select(`48_DWP_tray_barcode`) 
write_csv(PGOD21_DWPs, "PGOD21_DWPs.csv") # used this list plus SILLY_CODE and DNA_TRAY_CODE in oceanak_affected_DWPs.csv to do a vlookup in excel for the SILLY_CODE associated with the 48_DWP_tray_barcode - it's probably possible to do a vlookup type thing using join, but here we are...

PGOD21_DWPs_and_SILLYs <- read_csv("PGOD21_DWPs_and_SILLYs.csv") # renamed SILLY_CODE column in PGOD21_DWPs.csv to OG_SILLY_CODE, saved as new csv, and uploaded

attributes_xfer_and_SILLY_PGOD21 <- attributes_and_xfer_PGOD21 
attributes_xfer_and_SILLY_PGOD21$OG_SILLY_CODE <- PGOD21_DWPs_and_SILLYs$OG_SILLY_CODE

new_PGOD21_attributes_and_SILLY <- left_join(PGOD21.gcl$attributes, attributes_xfer_and_SILLY_PGOD21, by = "SillySource")

# break down new_PGOD21_attributes_and_SILLY into individual DWPs
PGOD21_by_DWP <- function(indata = "14331") {
  new_PGOD21_attributes_and_SILLY %>% 
    dplyr::filter(`48_DWP_tray_barcode` == indata)
}

PGOD21_DWP_14331 <- PGOD21_by_DWP(indata = "14331")
PGOD21_DWP_21941 <- PGOD21_by_DWP(indata = "21941")
PGOD21_DWP_14376 <- PGOD21_by_DWP(indata = "14376")
PGOD21_DWP_14334 <- PGOD21_by_DWP(indata = "14334")
PGOD21_DWP_14332 <- PGOD21_by_DWP(indata = "14332")
PGOD21_DWP_22174 <- PGOD21_by_DWP(indata = "22174")
PGOD21_DWP_14395 <- PGOD21_by_DWP(indata = "14395")
PGOD21_DWP_16104 <- PGOD21_by_DWP(indata = "16104")
PGOD21_DWP_16164 <- PGOD21_by_DWP(indata = "16164")
PGOD21_DWP_14463 <- PGOD21_by_DWP(indata = "14463")
PGOD21_DWP_28807 <- PGOD21_by_DWP(indata = "28807")
PGOD21_DWP_21900 <- PGOD21_by_DWP(indata = "21900")
PGOD21_DWP_14297 <- PGOD21_by_DWP(indata = "14297")
PGOD21_DWP_22108 <- PGOD21_by_DWP(indata = "22108")
PGOD21_DWP_22221 <- PGOD21_by_DWP(indata = "22221")
PGOD21_DWP_22104 <- PGOD21_by_DWP(indata = "22104")
PGOD21_DWP_2287 <- PGOD21_by_DWP(indata = "2287")
PGOD21_DWP_22107 <- PGOD21_by_DWP(indata = "22107")
PGOD21_DWP_14573 <- PGOD21_by_DWP(indata = "14573")
PGOD21_DWP_21938 <- PGOD21_by_DWP(indata = "21938")
PGOD21_DWP_15826 <- PGOD21_by_DWP(indata = "15826")
PGOD21_DWP_22050 <- PGOD21_by_DWP(indata = "22050")
PGOD21_DWP_21940 <- PGOD21_by_DWP(indata = "21940")
PGOD21_DWP_22710 <- PGOD21_by_DWP(indata = "22710")
PGOD21_DWP_22595 <- PGOD21_by_DWP(indata = "22595")
PGOD21_DWP_22569 <- PGOD21_by_DWP(indata = "22569")
PGOD21_DWP_22701 <- PGOD21_by_DWP(indata = "22701")
PGOD21_DWP_28929 <- PGOD21_by_DWP(indata = "28929")
PGOD21_DWP_16130 <- PGOD21_by_DWP(indata = "16130")
PGOD21_DWP_2228 <- PGOD21_by_DWP(indata = "2228")
PGOD21_DWP_28829 <- PGOD21_by_DWP(indata = "28829")
PGOD21_DWP_21937 <- PGOD21_by_DWP(indata = "21937")
PGOD21_DWP_21939 <- PGOD21_by_DWP(indata = "21939")
PGOD21_DWP_22260 <- PGOD21_by_DWP(indata = "22260")
PGOD21_DWP_14282 <- PGOD21_by_DWP(indata = "14282")
PGOD21_DWP_22218 <- PGOD21_by_DWP(indata = "22218")
PGOD21_DWP_14662 <- PGOD21_by_DWP(indata = "14662")
PGOD21_DWP_14663 <- PGOD21_by_DWP(indata = "14663")
PGOD21_DWP_22162 <- PGOD21_by_DWP(indata = "22162")
PGOD21_DWP_22591 <- PGOD21_by_DWP(indata = "22591")
PGOD21_DWP_22751 <- PGOD21_by_DWP(indata = "22751")
PGOD21_DWP_28812 <- PGOD21_by_DWP(indata = "28812")
PGOD21_DWP_22105 <- PGOD21_by_DWP(indata = "22105")
PGOD21_DWP_16132 <- PGOD21_by_DWP(indata = "16132")
PGOD21_DWP_28864 <- PGOD21_by_DWP(indata = "28864")
PGOD21_DWP_2288 <- PGOD21_by_DWP(indata = "2288")
PGOD21_DWP_22006 <- PGOD21_by_DWP(indata = "22006")
PGOD21_DWP_2232 <- PGOD21_by_DWP(indata = "2232")

# break down OGSillys into individual DWPs
PERB16_affected_DWPs <- unique(PERB16.gcl$attributes$DNA_TRAY_CODE)
PGILMOUR15_affected_DWPs <- unique(PGILMOUR15.gcl$attributes$DNA_TRAY_CODE)
PGILMOUR16_affected_DWPs <- unique(PGILMOUR16.gcl$attributes$DNA_TRAY_CODE)
PGILMOUR17_affected_DWPs <- unique(PGILMOUR17.gcl$attributes$DNA_TRAY_CODE)
PGILMOUR18_affected_DWPs <- unique(PGILMOUR18.gcl$attributes$DNA_TRAY_CODE)
PPADDY16_affected_DWPs <- unique(PPADDY16.gcl$attributes$DNA_TRAY_CODE)

OGSilly_by_DWP <- function(indata1 = PERB16.gcl$attributes, indata2 = "0000014331") {
  indata1 %>% 
    dplyr::filter(DNA_TRAY_CODE == indata2)
}

PERB16_DWP_14395 <- OGSilly_by_DWP(indata1 = PERB16.gcl$attributes, indata2 = "0000014395")
PERB16_DWP_14334 <- OGSilly_by_DWP(indata1 = PERB16.gcl$attributes, indata2 = "0000014334")
PERB16_DWP_14331 <- OGSilly_by_DWP(indata1 = PERB16.gcl$attributes, indata2 = "0000014331")
PERB16_DWP_14376 <- OGSilly_by_DWP(indata1 = PERB16.gcl$attributes, indata2 = "0000014376")
PERB16_DWP_14297 <- OGSilly_by_DWP(indata1 = PERB16.gcl$attributes, indata2 = "0000014297")
PERB16_DWP_14282 <- OGSilly_by_DWP(indata1 = PERB16.gcl$attributes, indata2 = "0000014282")
PERB16_DWP_14332 <- OGSilly_by_DWP(indata1 = PERB16.gcl$attributes, indata2 = "0000014332")

PGILMOUR15_DWP_2228 <- OGSilly_by_DWP(indata1 = PGILMOUR15.gcl$attributes, indata2 = "0000002228")
PGILMOUR15_DWP_2232 <- OGSilly_by_DWP(indata1 = PGILMOUR15.gcl$attributes, indata2 = "0000002232")

PGILMOUR16_DWP_14573 <- OGSilly_by_DWP(indata1 = PGILMOUR16.gcl$attributes, indata2 = "0000014573")
PGILMOUR16_DWP_14662 <- OGSilly_by_DWP(indata1 = PGILMOUR16.gcl$attributes, indata2 = "0000014662")
PGILMOUR16_DWP_14663 <- OGSilly_by_DWP(indata1 = PGILMOUR16.gcl$attributes, indata2 = "0000014663")
PGILMOUR16_DWP_15826 <- OGSilly_by_DWP(indata1 = PGILMOUR16.gcl$attributes, indata2 = "0000015826")

PGILMOUR17_DWP_22569 <- OGSilly_by_DWP(indata1 = PGILMOUR17.gcl$attributes, indata2 = "0000022569")
PGILMOUR17_DWP_22591 <- OGSilly_by_DWP(indata1 = PGILMOUR17.gcl$attributes, indata2 = "0000022591")
PGILMOUR17_DWP_22595 <- OGSilly_by_DWP(indata1 = PGILMOUR17.gcl$attributes, indata2 = "0000022595")
PGILMOUR17_DWP_22710 <- OGSilly_by_DWP(indata1 = PGILMOUR17.gcl$attributes, indata2 = "0000022710")
PGILMOUR17_DWP_22751 <- OGSilly_by_DWP(indata1 = PGILMOUR17.gcl$attributes, indata2 = "0000022751")
PGILMOUR17_DWP_22701 <- OGSilly_by_DWP(indata1 = PGILMOUR17.gcl$attributes, indata2 = "0000022701")

PGILMOUR18_DWP_28929 <- OGSilly_by_DWP(indata1 = PGILMOUR18.gcl$attributes, indata2 = "0000028929")
PGILMOUR18_DWP_28864 <- OGSilly_by_DWP(indata1 = PGILMOUR18.gcl$attributes, indata2 = "0000028864")
PGILMOUR18_DWP_28829 <- OGSilly_by_DWP(indata1 = PGILMOUR18.gcl$attributes, indata2 = "0000028829")
PGILMOUR18_DWP_28807 <- OGSilly_by_DWP(indata1 = PGILMOUR18.gcl$attributes, indata2 = "0000028807")
PGILMOUR18_DWP_28812 <- OGSilly_by_DWP(indata1 = PGILMOUR18.gcl$attributes, indata2 = "0000028812")

PPADDY16_DWP_16104 <- OGSilly_by_DWP(indata1 = PPADDY16.gcl$attributes, indata2 = "0000016104")
PPADDY16_DWP_14463 <- OGSilly_by_DWP(indata1 = PPADDY16.gcl$attributes, indata2 = "0000014463")
PPADDY16_DWP_16130 <- OGSilly_by_DWP(indata1 = PPADDY16.gcl$attributes, indata2 = "0000016130")
PPADDY16_DWP_16164 <- OGSilly_by_DWP(indata1 = PPADDY16.gcl$attributes, indata2 = "0000016164")
PPADDY16_DWP_16132 <- OGSilly_by_DWP(indata1 = PPADDY16.gcl$attributes, indata2 = "0000016132")
```

### Pull DWP fish_ids for PGOD21 and the OGSillys

```{r}
# pull fish_ids for PGOD21 DWPs
PGOD21_DWP_14331_fish_ids <- PGOD21_DWP_14331 %>% pull(FK_FISH_ID.x)
PGOD21_DWP_21941_fish_ids <- PGOD21_DWP_21941 %>% pull(FK_FISH_ID.x)
PGOD21_DWP_14376_fish_ids <- PGOD21_DWP_14376 %>% pull(FK_FISH_ID.x)
PGOD21_DWP_14334_fish_ids <- PGOD21_DWP_14334 %>% pull(FK_FISH_ID.x)
PGOD21_DWP_14332_fish_ids <- PGOD21_DWP_14332 %>% pull(FK_FISH_ID.x)
PGOD21_DWP_22174_fish_ids <- PGOD21_DWP_22174 %>% pull(FK_FISH_ID.x)
PGOD21_DWP_14395_fish_ids <- PGOD21_DWP_14395 %>% pull(FK_FISH_ID.x)
PGOD21_DWP_16104_fish_ids <- PGOD21_DWP_16104 %>% pull(FK_FISH_ID.x)
PGOD21_DWP_16164_fish_ids <- PGOD21_DWP_16164 %>% pull(FK_FISH_ID.x)
PGOD21_DWP_14463_fish_ids <- PGOD21_DWP_14463 %>% pull(FK_FISH_ID.x)
PGOD21_DWP_28807_fish_ids <- PGOD21_DWP_28807 %>% pull(FK_FISH_ID.x)
PGOD21_DWP_21900_fish_ids <- PGOD21_DWP_21900 %>% pull(FK_FISH_ID.x)
PGOD21_DWP_14297_fish_ids <- PGOD21_DWP_14297 %>% pull(FK_FISH_ID.x)
PGOD21_DWP_22108_fish_ids <- PGOD21_DWP_22108 %>% pull(FK_FISH_ID.x)
PGOD21_DWP_22221_fish_ids <- PGOD21_DWP_22221 %>% pull(FK_FISH_ID.x)
PGOD21_DWP_22104_fish_ids <- PGOD21_DWP_22104 %>% pull(FK_FISH_ID.x)
PGOD21_DWP_2287_fish_ids <- PGOD21_DWP_2287 %>% pull(FK_FISH_ID.x)
PGOD21_DWP_22107_fish_ids <- PGOD21_DWP_22107 %>% pull(FK_FISH_ID.x)
PGOD21_DWP_14573_fish_ids <- PGOD21_DWP_14573 %>% pull(FK_FISH_ID.x)
PGOD21_DWP_21938_fish_ids <- PGOD21_DWP_21938 %>% pull(FK_FISH_ID.x)
PGOD21_DWP_15826_fish_ids <- PGOD21_DWP_15826 %>% pull(FK_FISH_ID.x)
PGOD21_DWP_22050_fish_ids <- PGOD21_DWP_22050 %>% pull(FK_FISH_ID.x)
PGOD21_DWP_21940_fish_ids <- PGOD21_DWP_21940 %>% pull(FK_FISH_ID.x)
PGOD21_DWP_22710_fish_ids <- PGOD21_DWP_22710 %>% pull(FK_FISH_ID.x)
PGOD21_DWP_22595_fish_ids <- PGOD21_DWP_22595 %>% pull(FK_FISH_ID.x)
PGOD21_DWP_22569_fish_ids <- PGOD21_DWP_22569 %>% pull(FK_FISH_ID.x)
PGOD21_DWP_22701_fish_ids <- PGOD21_DWP_22701 %>% pull(FK_FISH_ID.x)
PGOD21_DWP_28929_fish_ids <- PGOD21_DWP_28929 %>% pull(FK_FISH_ID.x)
PGOD21_DWP_16130_fish_ids <- PGOD21_DWP_16130 %>% pull(FK_FISH_ID.x)
PGOD21_DWP_2228_fish_ids <- PGOD21_DWP_2228 %>% pull(FK_FISH_ID.x)
PGOD21_DWP_28829_fish_ids <- PGOD21_DWP_28829 %>% pull(FK_FISH_ID.x)
PGOD21_DWP_21937_fish_ids <- PGOD21_DWP_21937 %>% pull(FK_FISH_ID.x)
PGOD21_DWP_21939_fish_ids <- PGOD21_DWP_21939 %>% pull(FK_FISH_ID.x)
PGOD21_DWP_22260_fish_ids <- PGOD21_DWP_22260 %>% pull(FK_FISH_ID.x)
PGOD21_DWP_14282_fish_ids <- PGOD21_DWP_14282 %>% pull(FK_FISH_ID.x)
PGOD21_DWP_22218_fish_ids <- PGOD21_DWP_22218 %>% pull(FK_FISH_ID.x)
PGOD21_DWP_14662_fish_ids <- PGOD21_DWP_14662 %>% pull(FK_FISH_ID.x)
PGOD21_DWP_14663_fish_ids <- PGOD21_DWP_14663 %>% pull(FK_FISH_ID.x)
PGOD21_DWP_22162_fish_ids <- PGOD21_DWP_22162 %>% pull(FK_FISH_ID.x)
PGOD21_DWP_22591_fish_ids <- PGOD21_DWP_22591 %>% pull(FK_FISH_ID.x)
PGOD21_DWP_22751_fish_ids <- PGOD21_DWP_22751 %>% pull(FK_FISH_ID.x)
PGOD21_DWP_28812_fish_ids <- PGOD21_DWP_28812 %>% pull(FK_FISH_ID.x)
PGOD21_DWP_22105_fish_ids <- PGOD21_DWP_22105 %>% pull(FK_FISH_ID.x)
PGOD21_DWP_16132_fish_ids <- PGOD21_DWP_16132 %>% pull(FK_FISH_ID.x)
PGOD21_DWP_28864_fish_ids <- PGOD21_DWP_28864 %>% pull(FK_FISH_ID.x)
PGOD21_DWP_2288_fish_ids <- PGOD21_DWP_2288 %>% pull(FK_FISH_ID.x)
PGOD21_DWP_22006_fish_ids <- PGOD21_DWP_22006 %>% pull(FK_FISH_ID.x)
PGOD21_DWP_2232_fish_ids <- PGOD21_DWP_2232 %>% pull(FK_FISH_ID.x)

# pull fish_ids for OGSilly DWPs
PERB16_DWP_14395_fish_ids <- PERB16_DWP_14395 %>% pull(FK_FISH_ID)
PERB16_DWP_14334_fish_ids <- PERB16_DWP_14334 %>% pull(FK_FISH_ID)
PERB16_DWP_14331_fish_ids <- PERB16_DWP_14331 %>% pull(FK_FISH_ID)
PERB16_DWP_14376_fish_ids <- PERB16_DWP_14376 %>% pull(FK_FISH_ID)
PERB16_DWP_14297_fish_ids <- PERB16_DWP_14297 %>% pull(FK_FISH_ID)
PERB16_DWP_14282_fish_ids <- PERB16_DWP_14282 %>% pull(FK_FISH_ID)
PERB16_DWP_14332_fish_ids <- PERB16_DWP_14332 %>% pull(FK_FISH_ID)

PGILMOUR15_DWP_2228_fish_ids <- PGILMOUR15_DWP_2228 %>% pull(FK_FISH_ID)
PGILMOUR15_DWP_2232_fish_ids <- PGILMOUR15_DWP_2232 %>% pull(FK_FISH_ID)

PGILMOUR16_DWP_14573_fish_ids <- PGILMOUR16_DWP_14573 %>% pull(FK_FISH_ID)
PGILMOUR16_DWP_14662_fish_ids <- PGILMOUR16_DWP_14662 %>% pull(FK_FISH_ID)
PGILMOUR16_DWP_14663_fish_ids <- PGILMOUR16_DWP_14663 %>% pull(FK_FISH_ID)
PGILMOUR16_DWP_15826_fish_ids <- PGILMOUR16_DWP_15826 %>% pull(FK_FISH_ID)

PGILMOUR17_DWP_22569_fish_ids <- PGILMOUR17_DWP_22569 %>% pull(FK_FISH_ID)
PGILMOUR17_DWP_22591_fish_ids <- PGILMOUR17_DWP_22591 %>% pull(FK_FISH_ID)
PGILMOUR17_DWP_22595_fish_ids <- PGILMOUR17_DWP_22595 %>% pull(FK_FISH_ID)
PGILMOUR17_DWP_22710_fish_ids <- PGILMOUR17_DWP_22710 %>% pull(FK_FISH_ID)
PGILMOUR17_DWP_22751_fish_ids <- PGILMOUR17_DWP_22751 %>% pull(FK_FISH_ID)
PGILMOUR17_DWP_22701_fish_ids <- PGILMOUR17_DWP_22701 %>% pull(FK_FISH_ID)

PGILMOUR18_DWP_28929_fish_ids <- PGILMOUR18_DWP_28929 %>% pull(FK_FISH_ID)
PGILMOUR18_DWP_28864_fish_ids <- PGILMOUR18_DWP_28864 %>% pull(FK_FISH_ID)
PGILMOUR18_DWP_28829_fish_ids <- PGILMOUR18_DWP_28829 %>% pull(FK_FISH_ID)
PGILMOUR18_DWP_28807_fish_ids <- PGILMOUR18_DWP_28807 %>% pull(FK_FISH_ID)
PGILMOUR18_DWP_28812_fish_ids <- PGILMOUR18_DWP_28812 %>% pull(FK_FISH_ID)

PPADDY16_DWP_16104_fish_ids <- PPADDY16_DWP_16104 %>% pull(FK_FISH_ID)
PPADDY16_DWP_14463_fish_ids <- PPADDY16_DWP_14463 %>% pull(FK_FISH_ID)
PPADDY16_DWP_16130_fish_ids <- PPADDY16_DWP_16130 %>% pull(FK_FISH_ID)
PPADDY16_DWP_16164_fish_ids <- PPADDY16_DWP_16164 %>% pull(FK_FISH_ID)
PPADDY16_DWP_16132_fish_ids <- PPADDY16_DWP_16132 %>% pull(FK_FISH_ID)
```

# ##########################################################
### Dupe rate checks by DWP

A total of 19 PGOD21 DWPs don't have OGSilly DWP matches, presumably because they haven't been genotyped yet, leaving 29 DWPs for matching. **Note: LOKI2R_ind.GCL overwrites results per SILLY. Not sure right now how to deal with this for both PGOD21 and OGSillys...**

#### PERB16 DWP 14395

```{r}
LOKI2R_ind.GCL(sillyvec = PERB16, fish_ids = PERB16_DWP_14395_fish_ids,  username = .username, password = .password)
LOKI2R_ind.GCL(sillyvec = TestSillys, fish_ids = PGOD21_DWP_14395_fish_ids,  username = .username, password = .password)

# For comparison from T028
# DupCheckResults <- DupCheckBetweenSillys.GCL(KeySillys = "PSTOCK17QC", 
#                             KeySillyIDs = list("PSTOCK17QC" = fish_ids), 
#                             BetweenSillys = ProjectSillys, 
#                             loci = loci_intersect, 
#                             threshold = 0.9)

DupCheckResults <- DupCheckBetweenSillys.GCL(KeySillys = "PGOD21",
                            KeySillyIDs = list("PGOD21" = PGOD21_DWP_14395_fish_ids),
                            BetweenSillys = PERB16,
                            loci = loci,
                            threshold = 0.9)


rm(.password)
```

Top pairwise duplicate rate comparisons

```{r}
(dup_check_results <- dplyr::bind_rows(DupCheckResults, .id = "silly") %>% 
   tibble::as_tibble())
```

How many PGOD21 fish match only 1 other fish?

```{r}
dup_check_results %>% 
  count(Keysillyvial) %>% 
  filter(n == 1) %>% 
  left_join(dup_check_results, by = "Keysillyvial")
```

How many PGOD21 fish match >1 other fish?

```{r}
dup_check_results %>% 
  count(Keysillyvial) %>% 
  filter(n > 1) %>% 
  left_join(dup_check_results, by = "Keysillyvial") %>% 
  arrange(Keysillyvial)
```

Check top match vs. 2nd best

```{r}
dup_check_all_top2 <- dup_check_all %>% 
  mutate(qc_fish_id = str_remove(string = qc_fish_id, pattern = "PGOD21"),
         fish_id = str_remove(string = fish_id, pattern = c("PGILMOUR15", "PGILMOUR16_", "PGILMOUR17_", "PGILMOUR18_", "PERB16_", "PERB18_", "PPADDY16_", "PPADDY18_"))) %>% 
  group_by(qc_fish_id) %>% 
  dplyr::top_n(duplicate_rate, n = 2) %>% 
  mutate(diff = max(duplicate_rate) - min(duplicate_rate)) %>% 
  top_n(duplicate_rate, n = 1) %>% 
  mutate(matchy = qc_fish_id == fish_id) %>% 
  ungroup()

dup_ties <- dup_check_all_top2 %>% 
  count(qc_fish_id) %>% 
  filter(n > 1) %>% 
  pull(qc_fish_id)

dup_check_all_top2 %>% 
  filter(!(qc_fish_id %in% dup_ties & matchy == TRUE)) %>% 
  select(qc_fish_id, matchy) %>% 
  distinct() %>% 
  count(matchy)

dup_check_all_top2 %>% 
  ggplot(aes(x = diff, y = duplicate_rate, colour = matchy, text = qc_fish_id)) +
  geom_point() +
  theme_bw()

plotly::ggplotly(ggplot(
  data = dup_check_all_top2,
  aes(
    x = diff,
    y = duplicate_rate,
    colour = best_match,
    text = qc_fish_id
  )
) +
  geom_point() +
  theme_bw())
```

#### PERB16 DWP 14334

```{r}
LOKI2R_ind.GCL(sillyvec = PERB16, fish_ids = PERB16_DWP_14334_fish_ids,  username = .username, password = .password)
LOKI2R_ind.GCL(sillyvec = TestSillys, fish_ids = PGOD21_DWP_14334_fish_ids,  username = .username, password = .password)

rm(.password)
```

#### PERB16 DWP 14331

```{r}
LOKI2R_ind.GCL(sillyvec = PERB16, fish_ids = PERB16_DWP_14331_fish_ids,  username = .username, password = .password)
LOKI2R_ind.GCL(sillyvec = TestSillys, fish_ids = PGOD21_DWP_14331_fish_ids,  username = .username, password = .password)

rm(.password)
```

#### PERB16 DWP 14376

```{r}
LOKI2R_ind.GCL(sillyvec = PERB16, fish_ids = PERB16_DWP_14376_fish_ids,  username = .username, password = .password)
LOKI2R_ind.GCL(sillyvec = TestSillys, fish_ids = PGOD21_DWP_14376_fish_ids,  username = .username, password = .password)

rm(.password)
```

#### PERB16 DWP 14297

```{r}
LOKI2R_ind.GCL(sillyvec = PERB16, fish_ids = PERB16_DWP_14297_fish_ids,  username = .username, password = .password)
LOKI2R_ind.GCL(sillyvec = TestSillys, fish_ids = PGOD21_DWP_14297_fish_ids,  username = .username, password = .password)

rm(.password)
```

#### PERB16 DWP 14282

```{r}
LOKI2R_ind.GCL(sillyvec = PERB16, fish_ids = PERB16_DWP_14282_fish_ids,  username = .username, password = .password)
LOKI2R_ind.GCL(sillyvec = TestSillys, fish_ids = PGOD21_DWP_14282_fish_ids,  username = .username, password = .password)

rm(.password)
```

#### PERB16 DWP 14332

```{r}
LOKI2R_ind.GCL(sillyvec = PERB16, fish_ids = PERB16_DWP_14332_fish_ids,  username = .username, password = .password)
LOKI2R_ind.GCL(sillyvec = TestSillys, fish_ids = PGOD21_DWP_14332_fish_ids,  username = .username, password = .password)

rm(.password)
```

#### PGILMOUR15 DWP 2228

```{r}
LOKI2R_ind.GCL(sillyvec = PGILMOUR15, fish_ids = PGILMOUR15_DWP_2228_fish_ids,  username = .username, password = .password)
LOKI2R_ind.GCL(sillyvec = TestSillys, fish_ids = PGOD21_DWP_2228_fish_ids,  username = .username, password = .password)

rm(.password)
```

#### PGILMOUR15 DWP 2232

```{r}
LOKI2R_ind.GCL(sillyvec = PGILMOUR15, fish_ids = PGILMOUR15_DWP_2232_fish_ids,  username = .username, password = .password)
LOKI2R_ind.GCL(sillyvec = TestSillys, fish_ids = PGOD21_DWP_2232_fish_ids,  username = .username, password = .password)

rm(.password)
```

#### PGILMOUR16 DWP 14573

```{r}
LOKI2R_ind.GCL(sillyvec = PGILMOUR16, fish_ids = PGILMOUR16_DWP_14573_fish_ids,  username = .username, password = .password)
LOKI2R_ind.GCL(sillyvec = TestSillys, fish_ids = PGOD21_DWP_14573_fish_ids,  username = .username, password = .password)

rm(.password)
```

#### PGILMOUR16 DWP 14662

```{r}
LOKI2R_ind.GCL(sillyvec = PGILMOUR16, fish_ids = PGILMOUR16_DWP_14662_fish_ids,  username = .username, password = .password)
LOKI2R_ind.GCL(sillyvec = TestSillys, fish_ids = PGOD21_DWP_14662_fish_ids,  username = .username, password = .password)

rm(.password)
```

#### PGILMOUR16 DWP 14663

```{r}
LOKI2R_ind.GCL(sillyvec = PGILMOUR16, fish_ids = PGILMOUR16_DWP_14663_fish_ids,  username = .username, password = .password)
LOKI2R_ind.GCL(sillyvec = TestSillys, fish_ids = PGOD21_DWP_14663_fish_ids,  username = .username, password = .password)

rm(.password)
```

#### PGILMOUR16 DWP 15826

```{r}
LOKI2R_ind.GCL(sillyvec = PGILMOUR16, fish_ids = PGILMOUR16_DWP_15826_fish_ids,  username = .username, password = .password)
LOKI2R_ind.GCL(sillyvec = TestSillys, fish_ids = PGOD21_DWP_15826_fish_ids,  username = .username, password = .password)

rm(.password)
```

#### PGILMOUR17 DWP 22569

```{r}
LOKI2R_ind.GCL(sillyvec = PGILMOUR17, fish_ids = PGILMOUR17_DWP_22569_fish_ids,  username = .username, password = .password)
LOKI2R_ind.GCL(sillyvec = TestSillys, fish_ids = PGOD21_DWP_22569_fish_ids,  username = .username, password = .password)

rm(.password)
```

#### PGILMOUR17 DWP 22591

```{r}
LOKI2R_ind.GCL(sillyvec = PGILMOUR17, fish_ids = PGILMOUR17_DWP_22591_fish_ids,  username = .username, password = .password)
LOKI2R_ind.GCL(sillyvec = TestSillys, fish_ids = PGOD21_DWP_22591_fish_ids,  username = .username, password = .password)

rm(.password)
```

#### PGILMOUR17 DWP 22595

```{r}
LOKI2R_ind.GCL(sillyvec = PGILMOUR17, fish_ids = PGILMOUR17_DWP_22595_fish_ids,  username = .username, password = .password)
LOKI2R_ind.GCL(sillyvec = TestSillys, fish_ids = PGOD21_DWP_22595_fish_ids,  username = .username, password = .password)

rm(.password)
```

#### PGILMOUR17 DWP 22710

```{r}
LOKI2R_ind.GCL(sillyvec = PGILMOUR17, fish_ids = PGILMOUR17_DWP_22710_fish_ids,  username = .username, password = .password)
LOKI2R_ind.GCL(sillyvec = TestSillys, fish_ids = PGOD21_DWP_22710_fish_ids,  username = .username, password = .password)

rm(.password)
```

#### PGILMOUR17 DWP 22751

```{r}
LOKI2R_ind.GCL(sillyvec = PGILMOUR17, fish_ids = PGILMOUR17_DWP_22751_fish_ids,  username = .username, password = .password)
LOKI2R_ind.GCL(sillyvec = TestSillys, fish_ids = PGOD21_DWP_22751_fish_ids,  username = .username, password = .password)

rm(.password)
```

#### PGILMOUR17 DWP 22701

```{r}
LOKI2R_ind.GCL(sillyvec = PGILMOUR17, fish_ids = PGILMOUR17_DWP_22701_fish_ids,  username = .username, password = .password)
LOKI2R_ind.GCL(sillyvec = TestSillys, fish_ids = PGOD21_DWP_22701_fish_ids,  username = .username, password = .password)

rm(.password)
```

#### PGILMOUR18 DWP 28929

```{r}
LOKI2R_ind.GCL(sillyvec = PGILMOUR18, fish_ids = PGILMOUR18_DWP_28929_fish_ids,  username = .username, password = .password)
LOKI2R_ind.GCL(sillyvec = TestSillys, fish_ids = PGOD21_DWP_28929_fish_ids,  username = .username, password = .password)

rm(.password)
```

#### PGILMOUR18 DWP 28864

```{r}
LOKI2R_ind.GCL(sillyvec = PGILMOUR18, fish_ids = PGILMOUR18_DWP_28864_fish_ids,  username = .username, password = .password)
LOKI2R_ind.GCL(sillyvec = TestSillys, fish_ids = PGOD21_DWP_28864_fish_ids,  username = .username, password = .password)

rm(.password)
```

#### PGILMOUR18 DWP 28829

```{r}
LOKI2R_ind.GCL(sillyvec = PGILMOUR18, fish_ids = PGILMOUR18_DWP_28829_fish_ids,  username = .username, password = .password)
LOKI2R_ind.GCL(sillyvec = TestSillys, fish_ids = PGOD21_DWP_28829_fish_ids,  username = .username, password = .password)

rm(.password)
```

#### PGILMOUR18 DWP 28807

```{r}
LOKI2R_ind.GCL(sillyvec = PGILMOUR18, fish_ids = PGILMOUR18_DWP_28807_fish_ids,  username = .username, password = .password)
LOKI2R_ind.GCL(sillyvec = TestSillys, fish_ids = PGOD21_DWP_28807_fish_ids,  username = .username, password = .password)

rm(.password)
```

#### PGILMOUR18 DWP 28812

```{r}
LOKI2R_ind.GCL(sillyvec = PGILMOUR18, fish_ids = PGILMOUR18_DWP_28812_fish_ids,  username = .username, password = .password)
LOKI2R_ind.GCL(sillyvec = TestSillys, fish_ids = PGOD21_DWP_28812_fish_ids,  username = .username, password = .password)

rm(.password)
```

#### PPADDY16 DWP 16104

```{r}
LOKI2R_ind.GCL(sillyvec = PPADDY16, fish_ids = PPADDY16_DWP_16104_fish_ids,  username = .username, password = .password)
LOKI2R_ind.GCL(sillyvec = TestSillys, fish_ids = PGOD21_DWP_16104_fish_ids,  username = .username, password = .password)

rm(.password)
```

#### PPADDY16 DWP 14463

```{r}
LOKI2R_ind.GCL(sillyvec = PPADDY16, fish_ids = PPADDY16_DWP_14463_fish_ids,  username = .username, password = .password)
LOKI2R_ind.GCL(sillyvec = TestSillys, fish_ids = PGOD21_DWP_14463_fish_ids,  username = .username, password = .password)

rm(.password)
```

#### PPADDY16 DWP 16130

```{r}
LOKI2R_ind.GCL(sillyvec = PPADDY16, fish_ids = PPADDY16_DWP_16130_fish_ids,  username = .username, password = .password)
LOKI2R_ind.GCL(sillyvec = TestSillys, fish_ids = PGOD21_DWP_16130_fish_ids,  username = .username, password = .password)

rm(.password)
```

#### PPADDY16 DWP 16164

```{r}
LOKI2R_ind.GCL(sillyvec = PPADDY16, fish_ids = PPADDY16_DWP_16164_fish_ids,  username = .username, password = .password)
LOKI2R_ind.GCL(sillyvec = TestSillys, fish_ids = PGOD21_DWP_16164_fish_ids,  username = .username, password = .password)

rm(.password)
```

#### PPADDY16 DWP 16132

```{r}
LOKI2R_ind.GCL(sillyvec = PPADDY16, fish_ids = PPADDY16_DWP_16132_fish_ids,  username = .username, password = .password)
LOKI2R_ind.GCL(sillyvec = TestSillys, fish_ids = PGOD21_DWP_16132_fish_ids,  username = .username, password = .password)

rm(.username, .password)
```

