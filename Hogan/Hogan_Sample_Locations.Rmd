---
title: "Hogan Sample Locations"
output:
  html_notebook:
    theme: united
    toc: yes
editor_options: 
  chunk_output_type: inline
---

# Introduction

The purpose of these analyses is to relate reproductive success (RS) with spatial information from fish sampling areas (new information), origin, date, sex, and length. *Note* that we are only doing this for the even-year lineage (2014-2016) because there are not enough parent-offspring assignments from the odd lineage (2013-2015) to draw robust conclusions. Also note that Hogan is a **short** stream (~30m) and we assume that the entire stream was sampled each day. 

Our prior is that there may be spatial separation between hatchery- and natural-origin Pink Salmon and that this separation may help account for observed differences in RS. Spatial separation in spawning location has been observed in farmed- versus wild- Atlantic salmon, with farmed salmon more often found upriver of wild salmon (Moe et al. 2016; Okland et al. 1995; Thorstad et al. 1998). In contrast, wild Chinook from the Wenatchee River (WA) were found upstream of hatchery fish and had higher RS (Williamson et al. 2010). Additionally, spawning location may be influenced by return time if late-returning females have to choose less desirable locations (Fleming and Reynolds 2003). 

To test this spatial-separation hypothesis, we obtained sample location information from the contractor's Finsight database, which included both processing area number and GPS coordinates. Because processing areas overlapped and were inconsistent among years, we decided we couldn't use this variable as a proxy for sample location. Instead, we used an R script developed by Pete Rand at PWSSC that allowed us to convert GPS coordinates to distance from the mouth of the stream. We did this transformation and then combined this new variable with origin, date, and length from our RS analyses. We did exploratory plotting to examine relationships among RS, date, length, stream distance, and sex and test for multicollinearity among our variables. Following Bernston et al. (2011), Ford et al. (2012), and Janowitz-Koch et al. (2018), we used generalized linear models (GLM's) to evaluate relationships among RS, stream distance, length, origin and run timing separately for each sex.  

```{r setup, include=FALSE}
library(coin)
library(MASS)
library(scales)
library(tidyverse)
library(leaflet)
library(lubridate)
library(ggExtra)
library(gridExtra)
library(MuMIn)
library(GGally)

knitr::opts_chunk$set(warning=FALSE, message=FALSE)
```

# Read in, format, and filter data

Spatial data are saved in finsight in two ways: sample processing area and GPS coordinates. 
```{r read in and filter finsight data}
finsight_hogan <- read_csv("finsight_hogan.csv")

finsight_hogan$SurveyDate <- as.Date(finsight_hogan$SurveyDate, "%m/%d/%Y") 

finsight_hogan <- finsight_hogan %>% 
  mutate(year = as.numeric(format(SurveyDate, format = "%Y")),
         month = as.numeric(format(SurveyDate, format = "%m")),
         day = as.numeric(format(SurveyDate, format = "%d")))

finsight_hogan <- finsight_hogan %>% 
  mutate(Longitude = -abs(Longitude))

finsight_hogan_filtered <- finsight_hogan %>% 
  filter(Latitude > 60.207 & Longitude < -147.758)

finsight_hogan_filtered$ProcessingAreaNum <- as.factor(finsight_hogan_filtered$ProcessingAreaNum)
```

# Plot processing areas

Below we plot "processing areas" by year. It appears that processing areas changed by day and year.
```{r plot sample locations}
finsight_hogan_filtered %>%
  count(year, ProcessingAreaNum, Longitude, Latitude) %>%
  ggplot(aes(x = Longitude, y = Latitude, color = ProcessingAreaNum, size = n)) +
  geom_point(alpha = 0.2) +
  theme_bw() +
  facet_wrap(~ year)

finsight_hogan %>%
  count(year, ProcessingAreaNum, Longitude, Latitude) 
```

Seven processing areas were identified each year of sampling. These plots show the locations of the processing areas, with the size of the dot representing the number of individuals sampled. We plotted these locations to determine whether we could use this variable as a proxy for sample location. However, these plots reveal that processing areas are not discrete (they overlap) and that their locations are not consistent across years. 

# Convert coordinates to distance from stream mouth

Because we were not able to use processing area as a proxy for sample location, we used a script from Pete Rand (PWSSC) to transform GPS coordinates into a more meaningful measure: distance from the mouth of the stream. We then saved the output as a new variable, 'distance.'
```{r convert coordinates to distances}
# Calculates the geodesic distance between two points specified by radian latitude/longitude using the
# Haversine formula (hf)
gcd.hf <- function(long1, lat1, long2, lat2) {
  R <- 6371 # Earth mean radius [km]
  delta.long <- (long2 - long1)
  delta.lat <- (lat2 - lat1)
  a <- sin(delta.lat/2)^2 + cos(lat1) * cos(lat2) * sin(delta.long/2)^2
  c <- 2 * asin(min(1, sqrt(a)))
  d = R * c
  return(d) # Distance in km
}

# From Pete Rand on 1/14, high tide extent is 60.209, -147.761
finsight_hogan_filtered <- finsight_hogan_filtered %>% 
  mutate(Distance = unlist(pmap(list(long1 = min(Longitude), lat1 = min(Latitude), long2 = Longitude, lat2 = Latitude), gcd.hf))) %>% 
  mutate(Intertidal = case_when(Distance <= gcd.hf(long1 = min(Longitude), lat1 = min(Latitude), long2 = -147.761, lat2 = 60.209) ~ "Intertidal",
                                Distance > gcd.hf(long1 = min(Longitude), lat1 = min(Latitude), long2 = -147.761, lat2 = 60.209) ~ "Upstream"))

# A function to convert degrees to radians
# deg2rad <- function(deg) return(deg*pi/180)
```

# Join finsight table with parentage data

We joined spatial data from Finsight with parentage data.
```{r join tables}
paired_14_16_filter_parents <- read_csv("paired_14_16_filter_parents.csv")

finsight_parentage_hogan <- left_join(paired_14_16_filter_parents, finsight_hogan_filtered, 
                                      by = c("DNA Tray Code" = "SampleTrayId" , "DNA Tray Well Code" = "SampleCell")) %>% 
  mutate(origin = factor(origin, c("Natural", "Hatchery")))  # make factor to ensure hatchery != red

write_csv(finsight_parentage_hogan, "finsight_parentage_hogan.csv")
```

# Check for multi-collinearity

Before modeling RS, we checked for multi-collinearity among variables because we assumed that there would be some degree of non-independence. *Note* that these plots exclude individuals with missing data. 
```{r try ggpairs, fig.width=10, fig.height=10, warning=FALSE, message=FALSE}
reduced <- finsight_parentage_hogan %>% 
  rename(RS = n) %>% 
  mutate(Origin = case_when(origin == "Natural" ~ "N", 
                            origin == "Hatchery" ~ "H")) %>% 
  mutate(Origin = factor(Origin, levels = c("N", "H"))) %>% 
  select(`Sample Date`, Sex, `Length Mm`, Origin, RS, Distance, Intertidal) %>% 
  drop_na()

ggpairs(reduced, 
        mapping = aes(color = Origin, alpha = 0.5), 
        columns = c("Sample Date", "Length Mm", "Distance","RS", "Sex"), 
        columnLabels = c("Sample Date", "Length (mm)", "Distance (m)", "RS", "Sex"), 
        progress = FALSE, 
        lower = list(continuous = "smooth_loess", combo = wrap(ggally_facethist, position = "dodge2")),
        upper = list(continuous = wrap("cor", size = 4, hjust = 0.8), combo = "box"),
        diag = list(discrete = wrap(ggally_barDiag, position = "dodge2"))
        ) + 
  theme_bw() +
  theme(axis.text.x  = element_text(angle = 45, hjust = 1), 
        text = element_text(size = 16))
```

Overall, correlations among variables are pretty weak. Weak positive correlations were found between length and date (r = 0.28), RS and date (r = 0.03), distance and length (r = 0.13), and RS and length (r = 0.07). Weak negative correlations were found between distance and date (r = -0.08) and RS and distance (r = -0.10). 

# Individual plots

# Plot sample location by sample date for each sex

```{r plot location by date}
pMain <- ggplot(finsight_parentage_hogan, aes(x = `Sample Date`, y = Distance, color = origin)) +
  geom_jitter(height = 2, size = 2, alpha = 0.5) +
  geom_smooth() +
  facet_grid(Sex ~ .) +
  labs(colour = "Parent: Origin",
       shape = "Parent: Sex", size = "Reproductive Success") +
  xlab("Parental Sample Date") +
  ylab("Distance from Stream Mouth (m)") +
  theme_bw() +
  theme(legend.position = "none")

pTop <- ggplot(finsight_parentage_hogan, aes(x = `Sample Date`, fill = origin)) + 
  geom_histogram(position = "dodge2") +
  theme(legend.position = "none")

pRight <- ggplot(finsight_parentage_hogan, aes(x = Distance, fill = origin)) +
  geom_histogram(position = "dodge2") +
  theme(legend.position = "none") +
  coord_flip() +
  facet_grid(SEX ~ . )

g_legend <- function(a.gplot){ 
    tmp <- ggplot_gtable(ggplot_build(a.gplot)) 
    leg <- which(sapply(tmp$grobs, function(x) x$name) == "guide-box") 
    legend <- tmp$grobs[[leg]] 
    legend
} 

pEmpty <- ggplot(finsight_parentage_hogan, aes(x = `Sample Date`, fill = origin)) + 
  geom_histogram(position = "dodge2") +
  theme_bw()

grid.arrange(pTop, g_legend(pEmpty), pMain, pRight, ncol = 2, nrow = 2, widths = c(3,1), heights = c(1,3))

# ggExtra::ggMarginal(pMain, type = "histogram")
```

This plot shows the relationship between stream distance (m) and parental sample date, faceted by sex. Natural-origin fish, on average, arrive earlier than hatchery-origin (top plot). For both sexes, hatchery-origin fish tended to be sampled further upstream than natural-origin fish throughout the season, with a couple of exceptions (late August for females and early September for males). After ~ September 6, the majority of the fish were sampled within ~20m from the stream mouth. Gray bars represent loess smoothing CIs and points are jittered and partially transparent to avoid overplotting. 

## Plot RS by distance

For a better look at the relationship between RS and distance, we can plot RS by distance separately by sex.
```{r exploratory plot of RS by distance}
pMain <- finsight_parentage_hogan %>% 
  ggplot(aes(x = Distance, y = n, color = origin)) +
  geom_smooth() +
  geom_jitter(height = 0.5, alpha = 0.3) +
  facet_grid(Sex ~ .) +
  labs(colour = "Parent: Origin",
       shape = "Parent: Sex") +
  xlab("Distance from Stream Mouth (m)") +
  ylab("Reproductive Success") +
  theme_bw() +
  theme(legend.position = "bottom")

pTop <- ggplot(finsight_parentage_hogan, aes(x = Distance)) +
  theme_bw() +
  geom_histogram(aes(fill = origin), position = "dodge2") +
  theme(legend.position = "none")

grid.arrange(pTop, pMain, ncol = 1, nrow = 2, heights = c(1, 3))
```

These plots show RS (number of offspring) by distance from stream mouth (m), faceted by sex. For both sexes, natural-origin individuals had higher RS closer to the stream mouth than hatchery-origin individuals. Hatchery-origin individuals tended to consistent RS throught the stream and were more commonly sampled further upstream than natural-origin individuals. Gray bars represent loess smoothing CIs. Note that plots are jittered and points are partially transparent to prevent overplotting.

## Plot length by distance

Are fish separating within the stream based on body size?
```{r exploratory plot of length by distance}
finsight_parentage_hogan %>% 
  ggplot(aes(x = Distance, y = `Length Mm`, color = origin)) +
  geom_smooth() +
  geom_jitter(height = 0.5, alpha = 0.4) +
  facet_grid(Sex ~ .) +
  labs(title = "Distance from Stream Mouth by Parental Length", 
       colour = "Parent: Origin",
       shape = "Parent: Sex") +
  xlab("Distance from Stream Mouth (m)") +
  ylab("Parental Length (mm)") +
  theme_bw()
```

These plots show the relationship between parent length (mm) and distance from the stream mouth (m), faceted by sex. Overall, for both sexes, there were large size ranges at each sampling location. Smaller natural-origin females and males appear further upstream than larger individuals, perhaps indicating an inability to compete downstream. There is also a strong dip in the size of natural-origin males compared to hatchery-origin at about 10-15m from the stream mouth. Gray bars represent loess smoothing and points are jittered to prevent overplotting.

## Plot RS by date, sex, and location

These plots explore the relationship between RS and parent sample date, location (intertidal vs. upstream), and sex. This is an attempt to visualize how spatio-temporal dynamics affect RS.
```{r make new stat week variable}
# finsight_parentage_hogan_sw <- finsight_parentage_hogan %>% 
#   dplyr::mutate(statweek = dplyr::case_when(
#     `Sample Date` == "2014-08-16" ~ "33",
#     `Sample Date` == "2014-08-20" | `Sample Date` == "2014-08-22" ~ "34",
#     `Sample Date` >= "2014-08-25" & `Sample Date` <= "2014-08-31" ~ "35",
#     `Sample Date` >= "2014-09-03" & `Sample Date` <= "2014-09-06" ~ "36",
#     `Sample Date` >= "2014-09-10" & `Sample Date` <= "2014-09-14" ~ "37"))
# 
# finsight_parentage_hogan_sw %>% 
#   ggplot(aes(x = Distance, y = n, color = origin, shape = SEX)) +
#   geom_jitter(alpha = 0.5) +
#   geom_smooth() +
#   facet_grid(statweek ~ SEX) +
#   labs(title = "Reproductive Success by Parental Sample Location",
#        colour = "Parent: Origin",
#        shape = "Parent: Sex") +
#   xlab("Distance from Stream Mouth (m)") +
#   ylab("Reproductive Success") +
#   theme_bw()

finsight_parentage_hogan %>% 
  ggplot(aes(x = `Sample Date`, y = n, color = origin, shape = SEX)) +
  geom_jitter(alpha = 0.4) +
  geom_smooth() +
  facet_grid(Intertidal ~ SEX) +
  labs(title = "Reproductive Success by Parental Sample Date, Sex, and Location",
       colour = "Parent: Origin",
       shape = "Parent: Sex") +
  xlab("Distance from Stream Mouth (m)") +
  ylab("Reproductive Success") +
  theme_bw()
```

This plot shows RS (number of offspring) by parent sample date, faceted by sex and location (intertidal vs. upstream). Natural-origin fish of both sexes are more abundant earlier in the season than later. Fish sampled in the intertidal appear to have higher average RS than those sampled upstream - this is particularly true for natural-origin. Gray bars represent loess smoothing CIs and points are jittered and partially transparent to reduce overplotting. 

# Use GLM's to associate RS with sample location, date, origin, and length by sex

we used a negative binomial distribution model and log-linked function to evaluation associations between RS and origin, length, and sample date separately for females and males. We ran 16 models for each sex, identified statistically significant variables, and selected the best model based on AIC and model complexity. The first 13 models included various combinations of the four independent variables (date, length, origin, distance). For both sexes, only one variable was significant in these models: origin for females and length for males. In the last 3 models, we included the significant variable and interactions with the remaining 3 variables. 

## Female

```{r Female Even GLM}
Female.even <-  
  finsight_parentage_hogan %>% 
  filter(SEX == "F")

RS.glm.full <- glm.nb(n ~ `Sample Date` + `Length Mm` + origin + Distance, data = Female.even, link = log)

RS.glm.2 <- glm.nb(n ~ `Sample Date` + `Length Mm` + origin, data = Female.even, link = log)

RS.glm.3 <- glm.nb(n ~ `Length Mm` + origin, data = Female.even, link = log)

RS.glm.4 <- glm.nb(n ~ origin, data = Female.even, link = log)

RS.glm.5 <- glm.nb(n ~ `Length Mm`, data = Female.even, link = log)

RS.glm.6 <- glm.nb(n ~ `Sample Date`, data = Female.even, link = log)

RS.glm.7 <- glm.nb(n ~ Distance, data = Female.even, link = log)

RS.glm.8 <- glm.nb(n ~ `Sample Date` + `Length Mm` + Distance, data = Female.even, link = log)

RS.glm.9 <- glm.nb(n ~ `Length Mm` + Distance, data = Female.even, link = log)

RS.glm.10 <- glm.nb(n ~ `Sample Date` + origin, data = Female.even, link = log)

RS.glm.11 <- glm.nb(n ~ `Sample Date` + Distance, data = Female.even, link = log)

RS.glm.12 <- glm.nb(n ~ `Sample Date` + Distance + origin, data = Female.even, link = log)

RS.glm.13 <- glm.nb(n ~ Distance + origin, data = Female.even, link = log)

RS.glm.14 <- glm.nb(n ~ Distance * origin, data = Female.even, link = log)

RS.glm.15 <- glm.nb(n ~ `Sample Date` * origin, data = Female.even, link = log)

RS.glm.16 <- glm.nb(n ~ `Length Mm` * origin, data = Female.even, link = log)

RS.glm.17 <- glm.nb(n ~ `Sample Date` + `Length Mm` + origin + Intertidal, data = Female.even, link = log)

RS.glm.18 <- glm.nb(n ~ Intertidal, data = Female.even, link = log)

RS.glm.19 <- glm.nb(n ~ `Sample Date` + `Length Mm` + Intertidal, data = Female.even, link = log)

RS.glm.20 <- glm.nb(n ~ `Length Mm` + Intertidal, data = Female.even, link = log)

RS.glm.21 <- glm.nb(n ~ `Sample Date` + Intertidal, data = Female.even, link = log)

RS.glm.22 <- glm.nb(n ~ `Sample Date` + Intertidal + origin, data = Female.even, link = log)

RS.glm.23 <- glm.nb(n ~ Intertidal + origin, data = Female.even, link = log)

RS.glm.24 <- glm.nb(n ~ Intertidal * origin, data = Female.even, link = log)
```

For females, origin was consistently significantly associated with RS. The model with the lowest AIC included date, length, and origin (AIC = 736.2). The next best model included only length and origin (Delta AIC = 0.1).  

### Extract Akaike Weights

Akaike weights are another way of determining which model has the best fit, by calculating their conditional probabilities. 

The model with the highest weight (0.231) included both length and origin. 

```{r female_glm_summary}
female_model_summary <- bind_rows(
  lapply(c("full", 2:24), function(i) {
    fit <- get(paste0("RS.glm.", i))
    summary(fit)$coefficients %>% 
      as_tibble(rownames = "variable") %>% 
      mutate(name = paste0("RS.glm.", i)) %>% 
      mutate(model = as.character(fit$call)[2]) %>% 
      mutate(AIC = fit$aic) %>% 
      mutate(residual_deviance = fit$deviance) %>% 
      mutate(residual_df = fit$df.residual) %>% 
      mutate(null_deviance = fit$null.deviance) %>% 
      mutate(null_df = fit$df.null)
  } )
)

female_aic <- AIC(RS.glm.full, RS.glm.2, RS.glm.3, RS.glm.4, RS.glm.5, RS.glm.6, RS.glm.7, RS.glm.8, RS.glm.9, RS.glm.10, RS.glm.11, RS.glm.12, RS.glm.13, RS.glm.14, RS.glm.15, RS.glm.16, RS.glm.17, RS.glm.18, RS.glm.19, RS.glm.20, RS.glm.21, RS.glm.22, RS.glm.23, RS.glm.24)

female_aic <- female_aic %>% 
  mutate(AIC_weight = as.numeric(Weights(female_aic))) %>% 
  mutate(name = rownames(female_aic)) %>% 
  arrange(AIC) %>% 
  mutate(delta_AIC = AIC - min(AIC))

(female_model_summary <- female_model_summary %>% 
  left_join(female_aic, by = c("name", "AIC")) %>% 
  arrange(AIC)) %>% 
  select(name, model, df, AIC, delta_AIC, AIC_weight, variable, Estimate, `Std. Error`, residual_deviance, residual_df, null_deviance, null_df)

female_model_summary %>% 
  group_by(name) %>% 
  summarise(AIC_weight = max(AIC_weight), model = unique(model)) %>% 
  arrange(desc(AIC_weight))

female_model_summary %>% 
  select(-`Std. Error`, -`z value`, -`Pr(>|z|)`) %>% 
  spread(variable, Estimate, fill = NA)
```


## Male

```{r Male Even GLM}
Male.even <-  
  finsight_parentage_hogan %>% 
  filter(SEX == "M")

RS.glm.full <- glm.nb(n ~ `Sample Date` + `Length Mm` + origin + Distance, data = Male.even, link = log)

RS.glm.2 <- glm.nb(n ~ `Sample Date` + `Length Mm` + origin, data = Male.even, link = log)

RS.glm.3 <- glm.nb(n ~ `Length Mm` + origin, data = Male.even, link = log)

RS.glm.4 <- glm.nb(n ~ origin, data = Male.even, link = log)

RS.glm.5 <- glm.nb(n ~ `Length Mm`, data = Male.even, link = log)

RS.glm.6 <- glm.nb(n ~ `Sample Date`, data = Male.even, link = log)

RS.glm.7 <- glm.nb(n ~ Distance, data = Male.even, link = log)

RS.glm.8 <- glm.nb(n ~ `Sample Date` + `Length Mm` + Distance, data = Male.even, link = log)

RS.glm.9 <- glm.nb(n ~ `Length Mm` + Distance, data = Male.even, link = log)

RS.glm.10 <- glm.nb(n ~ `Sample Date` + origin, data = Male.even, link = log)

RS.glm.11 <- glm.nb(n ~ `Sample Date` + Distance, data = Male.even, link = log)

RS.glm.12 <- glm.nb(n ~ `Sample Date` + Distance + origin, data = Male.even, link = log)

RS.glm.13 <- glm.nb(n ~ Distance + origin, data = Male.even, link = log)

RS.glm.14 <- glm.nb(n ~ Distance * origin, data = Male.even, link = log)

RS.glm.15 <- glm.nb(n ~ `Sample Date` * origin, data = Male.even, link = log)

RS.glm.16 <- glm.nb(n ~ `Length Mm` * origin, data = Male.even, link = log)

RS.glm.17 <- glm.nb(n ~ `Sample Date` + `Length Mm` + origin + Intertidal, data = Male.even, link = log)

RS.glm.18 <- glm.nb(n ~ Intertidal, data = Male.even, link = log)

RS.glm.19 <- glm.nb(n ~ `Sample Date` + `Length Mm` + Intertidal, data = Male.even, link = log)

RS.glm.20 <- glm.nb(n ~ `Length Mm` + Intertidal, data = Male.even, link = log)

RS.glm.21 <- glm.nb(n ~ `Sample Date` + Intertidal, data = Male.even, link = log)

RS.glm.22 <- glm.nb(n ~ `Sample Date` + Intertidal + origin, data = Male.even, link = log)

RS.glm.23 <- glm.nb(n ~ Intertidal + origin, data = Male.even, link = log)

RS.glm.24 <- glm.nb(n ~ Intertidal * origin, data = Male.even, link = log)
```

For males, length was the only statistically significant factor across models. The model with the best fit included length and distance (AIC = 651.7).  

### Extract Akaike Weights

```{r male_glm_summary}
male_model_summary <- bind_rows(
  lapply(c("full", 2:24), function(i) {
    fit <- get(paste0("RS.glm.", i))
    summary(fit)$coefficients %>% 
      as_tibble(rownames = "variable") %>% 
      mutate(name = paste0("RS.glm.", i)) %>% 
      mutate(model = as.character(fit$call)[2]) %>% 
      mutate(AIC = fit$aic) %>% 
      mutate(residual_deviance = fit$deviance) %>% 
      mutate(residual_df = fit$df.residual) %>% 
      mutate(null_deviance = fit$null.deviance) %>% 
      mutate(null_df = fit$df.null)
  } )
)

male_aic <- AIC(RS.glm.full, RS.glm.2, RS.glm.3, RS.glm.4, RS.glm.5, RS.glm.6, RS.glm.7, RS.glm.8, RS.glm.9, RS.glm.10, RS.glm.11, RS.glm.12, RS.glm.13, RS.glm.14, RS.glm.15, RS.glm.16, RS.glm.17, RS.glm.18, RS.glm.19, RS.glm.20, RS.glm.21, RS.glm.22, RS.glm.23, RS.glm.24)

male_aic <- male_aic %>% 
  mutate(AIC_weight = as.numeric(Weights(male_aic))) %>% 
  mutate(name = rownames(male_aic)) %>% 
  arrange(AIC) %>% 
  mutate(delta_AIC = AIC - min(AIC))

(male_model_summary <- male_model_summary %>% 
  left_join(male_aic, by = c("name", "AIC")) %>% 
  arrange(AIC)) %>% 
  select(name, model, df, AIC, delta_AIC, AIC_weight, variable, Estimate, `Std. Error`, residual_deviance, residual_df, null_deviance, null_df)

male_model_summary %>% 
  group_by(name) %>% 
  summarise(AIC_weight = max(AIC_weight), model = unique(model)) %>% 
  arrange(desc(AIC_weight))

male_model_summary %>% 
  select(-`Std. Error`, -`z value`, -`Pr(>|z|)`) %>% 
  spread(variable, Estimate, fill = NA)
```

The model with the highest weight was also the one with the lowest AIC (weight = 0.333). The model includes length and distance. 

# Summary